# Check out https://docs.codemagic.io/getting-started/building-an-ionic-app/ for more information
# Please review and update values in curly braces
# Remove or comment out the workflows you don't require

workflows:
    # Ionic Capacitor dev workflows
    ionic-capacitor-ios-app-dev:
        name: Ionic Capacitor iOS App Dev
        environment:
            vars:
                XCODE_WORKSPACE: "ios/App/App.xcworkspace" # <- 'App' is the default workspace name for Capacitor projects
                XCODE_SCHEME: "App" # <- 'App' is the default Scheme name for Capacitor projects
                GOOGLE_SERVICE_INFO_DEV: Encrypted(Z0FBQUFBQmZyQUh5VTRpb2I0ZlotUy0tdnJKZzBZY1VnY19QN3IzYW1MbEtDdUExdFc1OVZRMlNxb0ZZNHllWFFSbnZ6czZLMUZYNllPYXFoQ3haODFWWVd5TEN4ZFlxekZNNUk1ZmhoNHY3RVItUHNmVzdjNGxmdXBIYmdxSDM1aTJKa3N6cUIxQ2JWSkFtcFpTLTVoc1NnN0JlTFY4TFBQY2hhX1R4UHd4Z2hKdS12MjhVSTBObjhIaXZqWEhxVnZPRDhlbk1wS2EzZmhCck1qd0g2Z2tHQnhnZVhucWpHa0t4M2FsOUI3Y0t3dzFXQlVfLUxZcDNyWEdwSzU0V18zakVDeGhRWFZaMW9QZ0lzaEhSczhWanU1MURDR0N2dXk4QVpTaXR1OTZlZjA3eE01Rnl3bE1rVmFTR3h4SXJTc3NLaExocmVIVnVIekdla19tTUQzMU9PYXBDaXB0YU1WcU94MU9CQXJyVkNjLURSZEozZUlGQnZ0MVFQdjFWUnlweGJKRWdXa3hTRFNzZkxBbnRraklpMVh0dHY3STdKWUJTbjVRNmVISko4cEFkaE1TNjlUYlhtcHhjVXc1N3lDanNzTXM5Y2Yxa01jdkpHdmdab3ZPU1dPdGJQd1pLcVhNc2lUOWROd192UUhxSTBKX1hRUTdweV9zcHFtZUx2azFIMzVDN0JaNG1tb0NJUVhOTjhDaWVPVzUtREJnY3BMM1FCeWpYal9jZzdKN3JRR0dIU05yQ0RmeHkxeWlxTWVzaGJ4REpYUVZoSXhXTU4tY1lvU1BZS1Q1TTJ6RGN5TENyaEt5LUtibldmUDlJc3VEcHA5Q0Z1b3h3cTFSMWZKTl8yMm5FT0ZvajJVbG0tZzlkdDFvR2gyaWMwQ0RLT2NTTldTeU5pejl6NVVMaTk1OVNlY2pWVUtMT1hPT3lyQTUzOHhPU08xdDhZd3BRRExEb3NlaXpZcmdHS1dLZHlvMk85OVBLdXpBRVdLVnktRVdnM0pCVURhc0lZUUhEeWVMeGpSbEZkc2dla1hSOUY4TTBScEtNMVRRcHFsSlA2dlJWVGM0SFd0cTVIcWdHZkVOblhFQm5ub2lGUTJ6MFhMSU5yanNlM1pDa1p5a0JNVHFuZHFQZzA2eW93WVFQNHJET2hsNWZzbHRZeVFCZEpidGJHV3loQlVhTXZQTnRzNHlWWlc4bVdFWlZpUmlRRkFBbzRBcFI4SnVadGVHejdkQVFhRGdUTzBiTXN5LXZnTjFYcUxoZncyanVSVE5VaExydXdYVmtvck4wWXBFYTdXZ21MTE5iWnhVOVZoMVpuaTR0TDNhb0JVU040N1Z4SkFTd2Q3cHNCR2NsWHpZWVFQRXBpZVBKanJXU2F5c1RLWWVqdDRLQXhVQXhSTThycndSQk5XdVNMUVBvVmhpRzgyZkVkYkFlSXlHYk5XeW5FMGJIeFlfR1BLakxKZWJRUmRnYzlON1RmS3dkRVFHaThYT2pnOWZVc0VsckdpWEpTek5kYlg0c09nNlZpWUt5MVc0dXdQWkRlSURMYk5VRFV2MWJMUnFyVWZBd2J4MHhqeHkyQThnZTRNV0YtcE5ROV9SZmhrZHRVOGpCX3RxdUw2TTA4ajhLekY2Y3VSX0pjWnVBLVBBc05fNXdsS0YzY0g3SDN6OWRhOUEzNjA4dFdlNkdhSEw0V3VwSVczNDVjSUd3WVhONG5RZndlY2dEZTJYeW82VDhrRFR6cjBsbHF3Sl9fVjJfQWhwejU0eHRwWHFkTXlfd2w0SVREbGhqV041TE5vVG1fc0JkNHk2ZjVQTm1tc2JCWHlza3g0MWh3R3hmeURKMEl5T3RmZXgzRDhaRVg5OHkxMEgyaWJMUWl3MmdiWEtVYzVZNlJtSFA0Z19hNXczdFBDTFprckJmcURlUlhYRFNkZmdON1pDcTVoUmdoY2JRM3R3Q1VOUUN1LUZ1SVl2QWpwYnhxbXBFLW8wTU96aG16NHMxN2hyZkQwQ1V3UVZMbWRleVBqN2h2SmJWS1ltNFNHSFNWeHRkNWg2ZGNMaFdoZmtXbVlEVU0xNWRBdmhuVGNoRWpRVDYwTGp0bV82VXFNb00tamMxTmtqaTRIeXVLa0wyamhsMXB3MmxyWUVWTllsUlVWcllmQldmWVk1N0lGYXhhRkhqaW9XazZBU1pqMEl4ZXBlSjM0Y0xZQThOSnpybGxQQlRHa3FTdlFQcjlFSjc2bVZqcHhoMEdTYWVoNVF2X3IyR2FLd3RNOU9Sbm5iaERXazBmYmpTT0lpcG9hMGoxSHhqOXpDWkg3RmZRMlVGV05wZ0h2T1Q1dkNYMmI1QUtPWi1xczFKVHlCY3JQS3FQR3NYNkdkeGpsSkQ5RG55MlN4M1Jzc0lpY3NBY3Q2aDJCN3lUWEVHMUxuYjhTTnh5VWZpTnVKZ2VUUkRrNFNQZEFqU3pjTGZMYkR0RVB6Z2NrWGVXeUEyVWtabHFQdV9BNXZ2bmN5SVJVRWt6S2Y2MXZIWEgwVkpoRTFPZmlmWE16SHhjVko0eC1admJuc3lTNDJDbkhJZHozdUlsdnIxX2VKUDU1THlUNjEwQ2lpTHJkVEM0cWJ0azVPZEZTM252ZU05ZWRWVm1KMllPS3F1dGhVNDJMaXZCcURqNHpWRmVXYkhYZmFBNE1STjRBbVFZRThWUVBzUFVkbUNoSURtMjNGNzZxZHdwbXZyTVRmcnpzUS1KMnZUTnVTZloxYWEyX2tYSEpiaERlYVVGN1huQUFvLVpYekhjMW9JYzBXb1pjdk1jakNtdHJoR3VFNmIwSGNWd3R1MEhQSFNmck1rczkzNkxKa0M1R2lhTHlpcUxuY0tDeHA1RzlQZ2J5OTk3a21Lajg5TVNZODV1eDREWG1LOG5NZEUzbERUVU01TUNpVmk0c2VWTGRjVkNNNWpUVWFfWlc5UG1VejFKLURydjAwelhocVRFdjg9)
            node: 12.19.0
        scripts:
            - echo ${GOOGLE_SERVICE_INFO_DEV} | base64 --decode > $PROJECT_ROOT/ios/App/App/GoogleService-Info.plist
            - npm install
            - npm run build     
            - npx cap sync
            - |
                # build iOS
                cd platforms/ios
                pod install
                xcodebuild build -workspace "$XCODE_WORKSPACE" -scheme "$XCODE_SCHEME" CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
        artifacts:
            - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app
            - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
    ionic-capacitor-android-app-dev:
        name: Ionic Capacitor Android App Dev
        environment:
            vars:
                GOOGLE_SERVICES_DEV: Encrypted(Z0FBQUFBQmZyQUpRRUpKYVItNHFwandJaVVydkJvZ2E1anpqRWVHWnNCODlLNzE4bkRndENXTl9YWWNPVThMazlSTEQ0ZDBUYkNGbGhvbnYxVzZQa3ZkWndCTzhDdUZJem1vbDBHc21KdDYzMXgwRW9vVkt5Y3RqU3R4bm8wMUpQVEFMaGp0N3I4UnVLbGZDeUMxUVJ5bURsS011a2pNS3pMakktbk02bGxBY096U2JLSHAzV2VpYndLTFFRZk9MMGZiWlFBalhSX1B3bE5HQkdJTkdwZGpsek9ZQXdxaVdjSXdGXzVsQjFpM0Q4Y3NtN0ZvR0RFTUFqcGhjN2NnSVBNVVcyN1JtVVZkN2FIZVdxZHpvLTQxdmZRZkVBeEVFQjY5WnNFSEYwTTJ1OEkya3o1WEpqLXdEa0F1Ti1YZ0hkaUY1cmpGQTlOZFR2RUdORHZ5aHROaVBtMk91ckR1QnFPQ0twYThBTHJiMHBFZFZ2WVR0WEVsa09Mc0czQmFacUV6aEktaVdJX1l4ZUtRNklCS0lER3d4RXhjdTdPZVdkT1BpTXgwLUhzeDIyQkFmRWtqdzF2cWpVMENvSUFiNmtmZEhScHpRMnNGZUZxbFBoS1c1RFJYN0NvdkVwelIycHoyX0puSnFQeEJBTUN3STdmU0NOSEdtSDFWV3o4NUhKb19aSlJtV0ZmeFZNZWlsYmJPQXlBWWhRVTctaHJ4M196c3I3MmFCeXMxYzI4ZDJqNDJfYVRLR0FhQW5KTDNQZm1CRzRvY0tnU0RIdEFQLVhabGExRDdiVGRPQmhpOFdSaXJkTDZjN0ZqWHFIV3o0eXJ6M3gzUExadnhuWGg0T2JZWDJTc09jeEViZm12TGdtOW5IRXVBbFpCa3dNX3l1MHduRzJoYnNoRmVVd0NjTXdMNU81dklZajV1cjQyM3oyZzJxbF9keFp3VnVHVjJ2YllKalo1djdGSFkybFB0Qm9TQ2N6d2ZwSmc1ZjNaeGhXYW5KYlE3VGlfRTBUNzBNVTVMWUZUYWZLUFlXaXdyVmx1UzZKVDNycXBwLTltV2xIOFZqcjJqZVA0ZVlXd1AyRnVyLWpTVjZQaTgyeGk5aVkyOXhtZnpWUkx1VlJqVTctUHRnb29vQVQ5anhGcnBGaUFXWmdFTENvaVRKb1JQNTdxdHFhN2JIY2U1aUhzeXAtc3o2NWFZd0tabUI1SUl1T0xhZnVYNFdNcWdIT2dscC1ud3VhNk5nWTV2bjU2OXZJR1ltTzZWZWVaUXJnV3Z4cG5zSTZ1X0s2UzFXS0VpTmRxLTlkV0l2Qkd0d0FkWHdSdVdJbFFGbzFPVUl1OG5SWmtSQlFJelB6OXNuS0NKbHN2Sl81V1Z4YlVyVjNYRVR2VDJpVlNUVlU0ZVlKZ0dmcTBVRlZyeGRhMHBjak9Oc05ETGVFYUJkYmt6QjVhV2M2bjhzd2k2V2MyTkFOWUlwb29jQVFpVmJTa05lenBhTWo3ZnpjZkY3WDdLbksyOGFyWW1IQV82QzlhaENSS1VSZjk3SVBocElUYzRranBLekZFWHFuZXZyekZ5eW1saEQ4OWpKc2NkeUtaMnpUY1VmZW1Ra29TT18wWmFKQVdvVXFTZVlld1BGUzMwUzUyZkowdGZJQWV0aS1qT3NOS3FZc1FYb1dMZW5CMjB3QkYzT29kbkZDUV9OWEdVRDR5U3dPV2hReHpnaWtHMC15TzdjdVlkRjRETVhFSWVPMUhReVotQXQ4OWlNbk0yb2ZuQTQ5a3F6ZFNiSnNjSnp5Mzd3MDc1anRfRDNOR3pBNEp4Z0FmMGM3TzI2RFJpR0FfQnRzRGpIYThtSW9iYlZudE9rQkNzU0RSd2JqWnU2aHRNOXpvOF9oMVUzMzNyYXJHWnhfc0lQZlY0WEpJc1o5blU0Q2owZTNiVWJ0VFlrY1FWWGNvR0RzNjlWRnFQbUtuYVRrWTlwSmV1Qzg5UUNWQXZ2OFBiNi1zT2lwSS0yQ1VfUlVkSDg4UnlNS2hiTmVvS2tyT2VqX1NhdG5uLVhLV05wUUwxeUU2NWtGS3FxRVY1XzY3aENEOGVIdGZ4YXVybWppNnNLVUxuR3piMjJwMGx4bnpONG5nRlpsY3dJUmloTEJyY0hoaXIxNFBGYnZockk5Y01QdHJmM2thTkJVM0ZFQzBQQUUxRmhFQ0MtUDlzZ0IycXpJdV9DcFhHd0FGUEZ3aFQxdnY0QVdvdXFndHhqVDAyYmJqbUFudEFYT0ppb0NReHpKNmMwU1djbm5meW8tM2JES1lFd1hYSHQ2QmpXZkE5ZW8wMURkcGc0cEtSNGZmaFJ3dzZVYnZWXzhHZjJFS2dIbHVneHJjOVJ4NHpZRmw1T2xMWDlhS09RdENGcndQTUxOd0pNV2dTaFlLZmR0T09rajhFQi1fMFBiQUVhQ1lyNW94NHlwcGpEZHh3Z1ljQUdnZzNlci16SjFSc2lsS0lGU1drRWZLUXA4cW9RWk5HS09nVkNUMk81bnJ1VEgzVEk2VGxBVWtKa1NCTVhoMVNxakR0a1ZoUlpReS10R1JLWFFzenctZVJkRlQ4cDE3dTJTc0pCN0VqUzNRMk1jT19UZGtlLXJjaDhCTEhxNnpwRUtjdWZxSDRveHl3R1lvNFo5VEczcGRGbFdDR3RpUk90YTJZTVctRTdqdE9Ob0taOW9Kem1MTkJUQm85SUlLRHYxMHh5VzlCMEt5dlFOb3hIaGVEXzRGUXJfOUd0Q3UyUXJfdGdQcnNwU2Y1d1d2QW9KdjRoamZ6VTROM2RMal8waHJRRE5QMUxKSXZydGNDVVg3Q1JYSTRLLXJseXEycDJhYXJSMDU1UnYtTkZXN0V4R3I1ZU9MRjBhZEdiWmNvRmEwV2xUNEdoQzNZeFdQbnFyNm56bnUyZnFrSWkzeHdsM0JkVC1obHpSYzFEVllfQXhqZFJlVnFfa1pXT1dFZmVaQWJwUk40SnpMTWNfRTBlY3MzemRlS0ZDSWpkY3lmc0JDb1FPR2ZwdUJQWlpxVXRyZkZxQWZGNFM1bDZfT0ZycnhrMWlvTFc2MndmY2I4emhZSWhxUnNJaVNDbVJ6TDZzZHBRXzNwNlJIWmJLbTZUSjdiUnU3dHFjbUZvRjE5WFFLWEJJeVYtTkN5eUE5aFF4VzBaUmlIdGJobWFwTXBXZGt2dTZjTTZRNk92T3RuUXZZX0hjdzBnQ01PQ00teUF5a3VqTldCa1RBRjFSeFJHLUdyNmFYVTJkZU1LczJnWmlldTJGWnRrSGoyRFF3PT0=)
            node: 12.19.0
        scripts:
            - echo ${GOOGLE_SERVICES_DEV} | base64 --decode > $PROJECT_ROOT/android/app/google-services.json 
            - npm install
            - npm run build     
            - npx cap sync
            - |
                # build Android
                cd android
                ./gradlew assembleDebug
        artifacts:
            - android/app/build/outputs/**/*.apk

    # Ionic Capacitor prod workflows
    ionic-capacitor-ios-app-prod:
        name: Ionic Capacitor iOS App Prod
        environment:
            vars:
                XCODE_WORKSPACE: "ios/App/App.xcworkspace" # <- 'App' is the default workspace name for Capacitor projects
                XCODE_SCHEME: "App" # <- 'App' is the default Scheme name for Capacitor projects
            node: 12.19.0
        scripts:
            - npm install
            - npm run build     
            - npx cap sync
            - |
                # build iOS
                cd platforms/ios
                pod install
                xcodebuild build -workspace "$XCODE_WORKSPACE" -scheme "$XCODE_SCHEME" CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO
        artifacts:
            - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app
            - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
    ionic-capacitor-android-app-prod:
        name: Ionic Capacitor Android App Prod
        environment:
            node: 12.19.0
        scripts:
            - npm install
            - npm run build     
            - npx cap sync
            - |
                # build Android
                cd android
                ./gradlew assembleDebug
        artifacts:
            - android/app/build/outputs/**/*.apk